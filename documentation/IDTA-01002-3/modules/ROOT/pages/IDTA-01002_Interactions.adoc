////
Copyright (c) 2023 Industrial Digital Twin Association

This work is licensed under a [Creative Commons Attribution 4.0 International License](
https://creativecommons.org/licenses/by/4.0/). 

SPDX-License-Identifier: CC-BY-4.0

////


= Interactions

Interactions describe the sequence of calls of operations by a client application to achieve a defined goal in a use case. Future versions of the document will describe interactions for further use cases.

Currently, only the key use case “Access a submodel in a distributed system” with focus on a completely decentralized Industry 4.0 system is described.

Since the interaction diagram in the current version only describes a first subset of interactions, some constraints and assumptions are made according to the configuration and qualities of the system.

Constraints and assumptions for calling an AAS and a submodel operation by a client application:

* The calling application hast to be aware that endpoints may change at any time. If the application has cached an endpoint that is no longer vivid, the application needs to start the interaction to resolve the appropriate endpoint again from the beginning.
* Endpoints for infrastructure interfaces like AAS registries are known at design time of the client application or configured manually before start-up.
* The endpoint information of the submodel registry must be known to the client application. The following questions are subject to discussion for future interaction versions:
[loweralpha]
. Will it be accessible via the AAS interface and therefore become a mandatory part of a standard interaction?
. How much “control” of submodels is implemented in the AAS and how are distributed submodels handled, which are deployed in network areas not accessible by the AAS server application?
* The AAS server application itself is instantiated and registered by calling an AAS registry interface.
* The AAS-ID is known to the calling application.
* Access to any API is allowed only if authenticated (mechanisms for authentication are to be described separately) and response follows a defined access rights model for all calls.

In Figure 7 below, the interaction starts with a client application resolving the interface endpoint of an Asset Administration Shell registry with a known asset ID. The AAS registry provides the AAS Descriptor object belonging to this asset ID and containing the Submodel Descriptors of the Submodels, which are part of the related AAS. Both descriptor kinds, those of the Asset Administration Shell and those of the Submodels, contain endpoint information for the respective AAS and Submodel Repositories. AAS interface operations – independent of the underlying protocol – are used to retrieve the AAS from the AAS repository answering at one of the supplied endpoints. In the sequence shown in Figure 7, one submodel of this AAS is also provided through the same repository. For the second submodel, however, only the submodel identifier is provided by the AAS registry, while the endpoint information is empty. Therefore, the client application must execute another look-up at a dedicated Submodel Registry, which responds with one Submodel Descriptor object. Equipped with this information, the client application locates the stand-alone Submodel Repository and downloads the second submodel.

.Interactions for Client Applications using AAS and Submodel Interfaces (independent Submodel Registry)
image::image26.png[image26,width=642,height=350]

Figure 8 shows a slight variant of the scenario in Figure 7. The AAS Registry only returns the AAS Descriptor without any Submodel Descriptors. The client application retrieves the AAS from the discovered AAS Repository endpoint and learns about its submodel references. Using these references, the client can ask a Submodel Registry, in this case also hosted by the repository server, for the respective Submodel Descriptors. It understands that the Submodels are also available at the same server and downloads them by sending requests to the Submodel Interface.

.Interaction for Client Application using AAS and Submodel Interfaces (included Submodel Registry)
image::image27.png[Ein Bild, das Diagramm enthält. Automatisch generierte Beschreibung,width=624,height=326]

The difference between Interface and API Operations is outlined in Figure 9. This sequence translates the interaction on the interface level of Figure 7, which is protocol-independent and therefore can be implemented in several different manners, to the specific HTTP API Operations. The generic operations are replaced with HTTP requests, e.g. “GetAasDescriptorById” with “GET /shell-descriptors/<aas-id>”. The returned objects are shortened for better readability. The first request to the Submodel API shows the concatenated path (“/shells/<aas-id>/aas” + “/submodels/<submodel-id>”) and illustrates how contained submodels can be provided natively through an AAS API.

.Interaction for Client Application using AAS and Submodels (for HTTP API Operations)
image::image28.png[image28,width=642,height=350]

